{"version":3,"sources":["withTranslator.jsx"],"names":["withTranslator","translator","context","dictionary","Object","keys","length","hasOwnTranslator","derive","ensureTranslator","ctx","props","children","others","lang","locale","Component","displayName","Target","name","propTypes","PropTypes","string","defaultProps","contextTypes","object","childContextTypes"],"mappings":";;;;;;;;;;AAEA;;;;AACA;;;;;;;;;;;;+eAHA;AACA;;;AAGA;;AAEA;;AAEA,IAAMA,iBAAiB,SAAjBA,cAAiB;AAAA,SAAc;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA,2CAkBd;AACjB,cAAI,KAAKC,UAAT,EAAqB;AACnB;AACD;AACD,cAAMA,aAAa,KAAKC,OAAL,CAAaD,UAAhC;AACA,cAAIE,cAAc,IAAd,IAAsBC,OAAOC,IAAP,CAAYF,UAAZ,EAAwBG,MAAlD,EAA0D;AACxD,iBAAKC,gBAAL,GAAwB,IAAxB;AACA,iBAAKN,UAAL,GAAkBA,WAAWO,MAAX,CAAkBL,UAAlB,CAAlB;AACD,WAHD,MAGO;AACL,iBAAKI,gBAAL,GAAwB,KAAxB;AACA,iBAAKN,UAAL,GAAkBA,UAAlB;AACD;AACF;AA9BgC;AAAA;AAAA,0CAgCf;AAChB,eAAKQ,gBAAL;AACA,cAAI,KAAKF,gBAAT,EAA2B;AACzB,gBAAMG,MAAM;AACVT,0BAAY,KAAKA;AAEnB;AACA;AACA;AALY,aAAZ,CAMA,OAAOS,GAAP;AACD;AACD,iBAAO,EAAP;AACD;AA5CgC;AAAA;AAAA,6CA8CZ;AACnB,eAAKD,gBAAL;AACD;AAhDgC;AAAA;AAAA,+CAkDV;AACrB,eAAKF,gBAAL,GAAwB,KAAxB;AACA,eAAKN,UAAL,GAAkB,IAAlB;AACD;AArDgC;AAAA;AAAA,iCAuDxB;AAAA,uBACyB,KAAKU,KAD9B;AAAA,cACCC,QADD,UACCA,QADD;AAAA,cACcC,MADd;;AAEP,cAAMC,OAAO,KAAKH,KAAL,CAAWG,IAAX,IAAmB,KAAKZ,OAAL,CAAaY,IAA7C;AACA,cAAIA,IAAJ,EAAU;AACR,iBAAKb,UAAL,CAAgBc,MAAhB,CAAuBD,IAAvB;AACD;AACD,iBACE;AAAC,kBAAD;AAAA,yBAAYD,MAAZ,IAAoB,YAAY,KAAKZ,UAArC;AACGW;AADH,WADF;AAKD;AAlEgC;;AAAA;AAAA,MACNI,gBADM,UAE1BC,WAF0B,wBAEMC,OAAOD,WAAP,IAAsBC,OAAOC,IAA7B,IAAqC,WAF3C,gBAG1BC,SAH0B,GAGd;AACjBN,YAAMO,oBAAUC;AADC,KAHc,SAM1BC,YAN0B,GAMX;AACpBT,YAAM;AADc,KANW,SAS1BU,YAT0B,GASX;AACpBvB,kBAAYoB,oBAAUI,MADF;AAEpBX,YAAMO,oBAAUC;AAFI,KATW,SAa1BI,iBAb0B,GAaN;AACzBzB,kBAAYoB,oBAAUI;AACtB;AAFyB,KAbM;AAAA,GAAd;AAAA,CAAvB;;kBAsEezB,c","file":"withTranslator.js","sourcesContent":["// MIT license (see LICENSE)\n// Copyright 2019 @rigidrabbit\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\n// import createTranslator from './createTranslator'\n\n// const nop = createTranslator()\n\nconst withTranslator = dictionary => Target => (\n  class WithTranslator extends Component {\n    static displayName = `WithTranslator(${Target.displayName || Target.name || 'Component'})`\n    static propTypes = {\n      lang: PropTypes.string,\n    }\n    static defaultProps = {\n      lang: null,\n    }\n    static contextTypes = {\n      translator: PropTypes.object,\n      lang: PropTypes.string,\n    }\n    static childContextTypes = {\n      translator: PropTypes.object,\n      // lang: PropTypes.string,\n    }\n\n    ensureTranslator() {\n      if (this.translator) {\n        return\n      }\n      const translator = this.context.translator\n      if (dictionary != null && Object.keys(dictionary).length) {\n        this.hasOwnTranslator = true\n        this.translator = translator.derive(dictionary)\n      } else {\n        this.hasOwnTranslator = false\n        this.translator = translator\n      }\n    }\n\n    getChildContext() {\n      this.ensureTranslator()\n      if (this.hasOwnTranslator) {\n        const ctx = {\n          translator: this.translator,\n        }\n        // if (this.props.lang != null) {\n        //   ctx.lang = this.props.lang\n        // }\n        return ctx\n      }\n      return {}\n    }\n\n    componentWillMount() {\n      this.ensureTranslator()\n    }\n\n    componentWillUnmount() {\n      this.hasOwnTranslator = false\n      this.translator = null\n    }\n\n    render() {\n      const { children, ...others } = this.props\n      const lang = this.props.lang || this.context.lang\n      if (lang) {\n        this.translator.locale(lang)\n      }\n      return (\n        <Target {...others} translator={this.translator}>\n          {children}\n        </Target>\n      )\n    }\n  }\n)\n\nexport default withTranslator\n"]}